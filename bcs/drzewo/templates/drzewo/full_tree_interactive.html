{# templates/drzewo/full_tree_interactive.html #}
{% load static %}
<!DOCTYPE html>
<html lang="pl">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Interaktywny Rodowód</title>
        <link rel="stylesheet"
              href="{% static 'drzewo/css/interactive_tree.css' %}">
        <script src="/static/vendor/d3.v7.min.js"></script>
        <style>
            #sidebar { width:260px; background:#222; padding:12px; box-sizing:border-box; }
            #stage { flex:1; position:relative; }
            svg { width:100%; height:100%; display:block; }
            .node.hover circle { stroke:yellow; stroke-width:2px; }
        </style>
    </head>
    <body>
        <div id="sidebar">
            <div class="sidebar__section">
                <h2>Filtry</h2>
                <form method="get">
                    {{ form.as_p }}
                    <input type="hidden" name="submitted" value="1">
                    <button type="submit">Odśwież</button>
                </form>
            </div>
            <hr>
            <div class="sidebar__section">
                <h3>Kolorowanie</h3>
                <select id="color-mode">
                    <option value="none">Brak</option>
                    <option value="generation">Pokolenie</option>
                    <option value="status">Status</option>
                    <option value="aktywnosc">Aktywność</option>
                    <option value="lineages">Rody</option>
                </select>
                <template id="color-mode-options-checkbox-template">
                    <label>
                        <input type="checkbox" class="color-mode">
                        <span class="checkbox-text"></span>
                    </label>
                    <br>
                </template>
                <br>
                <br>
                <div id="color-mode-options"></div>
                <template id="legend-item-template">
                    <div class="sidebar__legend-item">
                        <div class="sidebar__legend-item-color"></div>
                        <span class="sidebar__legend-item-text"></span>
                    </div>
                </template>
                <div id="legend" class="sidebar__legend"></div>
            </div>
            <hr>
            <div class="sidebar__section">
                <h3>Widoki</h3>
                <label>
                    <input type="checkbox" class="view-mode" value="years">
                    Lata
                </label>
                <br>
                <label>
                    <input type="checkbox" class="view-mode" value="descendants">
                    Potomkowie
                </label>
                <br>
                <label>
                    <input type="checkbox" class="view-mode" value="color-nodes">
                    Koloruj węzły
                </label>
                <div id="color-picker" class="sidebar__color-picker" style="display: none;">
                    <input type="color" id="node-color-input" value="#ff0000">
                    <span id="node-color-label"> Wybierz kolor</span>
                </div>
            </div>
            <hr>
            <p>Kliknij węzeł, by otworzyć szczegóły. Najedź → podgląd.</p>
        </div>
        <div class="tree" id="stage">
            <svg id="svg" class="tree__svg">
            </svg>
            <div id="tooltip" class="tree__tooltip"></div>
        </div>
        <script>
            window.TREE_CONFIG = {
                onp: {{ onp|yesno:'true,false' }}
            };
        </script>
        <script type="module"
                src="{% static 'drzewo/js/interactive_graph/main.js' %}"></script>
    </body>
</html>
