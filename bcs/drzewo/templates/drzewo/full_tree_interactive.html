{# templates/drzewo/full_tree_interactive.html #}
{% load static %}
<!DOCTYPE html>
<html lang="pl">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Interaktywny Rodowód</title>
        <link rel="stylesheet"
              href="{% static 'drzewo/css/interactive_tree.css' %}">
        <script src="https://d3js.org/d3.v7.min.js"></script>
        <style>
            body { margin:0; display:flex; height:100vh; background: #ffffff; color:#eee; }
            #sidebar { width:260px; background:#222; padding:12px; box-sizing:border-box; }
            #stage { flex:1; position:relative; }
            svg { width:100%; height:100%; display:block; }
            .node circle { stroke:#222; stroke-width:1px; }
            .node text { font-size:12px; fill:#fff; pointer-events:none; }
            .node.hover circle { stroke:yellow; stroke-width:2px; r:14; }
            .tooltip { 
                position:absolute; pointer-events:none; background:rgba(0,0,0,0.8); color:#fff; padding:6px 8px; 
                border-radius:6px; font-size:13px; display:none; 
            }
        </style>
    </head>
    <body>
        <div id="sidebar">
            <div class="sidebar__section">
                <h2>Filtry</h2>
                <form method="get">
                    {{ form.as_p }}
                    <input type="hidden" name="submitted" value="1">
                    <button type="submit">Odśwież</button>
                </form>
            </div>
            <hr>
            <div class="sidebar__section">
                <h3>Kolorowanie</h3>
                <select id="color-mode">
                    <option value="none">Brak</option>
                    <option value="generation">Pokolenie</option>
                    <option value="status">Status</option>
                    <option value="aktywnosc">Aktywność</option>
                </select>
                <div id="legend" class="sidebar__legend"></div>
            </div>
            <hr>
            <div class="sidebar__section">
                <h3>Widoki</h3>
                <label>
                    <input type="checkbox" class="view-mode" value="years">
                    Lata
                </label>
                <br>
                <label>
                    <input type="checkbox" class="view-mode" value="descendants">
                    Potomkowie
                </label>
                <br>
                <label>
                    <input type="checkbox" class="view-mode" value="color-nodes">
                    Koloruj węzły
                </label>
                <div id="color-picker" class="sidebar__color-picker"></div>
            </div>
            <hr>
            <p>Kliknij w węzeł → otwiera szczegóły. Najedź → podgląd.</p>
        </div>
        <div class="tree" id="stage">
            <svg id="svg" class="tree__svg">
            </svg>
            <div id="tooltip" class="tree__tooltip"></div>
        </div>
        <script>
            window.TREE_CONFIG = {
                onp: {{ onp|yesno:'true,false' }}
            };
        </script>
        <script type="module"
                src="{% static 'drzewo/js/interactive_graph/main.js' %}"></script>
    </body>
</html>
